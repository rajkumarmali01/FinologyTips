// Shows unique Building names from both tables (searchable)
With(
    { q: Trim(cmbBuilding.SearchText) },
    Sort(
        Distinct(
            Ungroup(
                Table(
                    { L: If(
                            IsBlank(q),
                            ShowColumns(TableA, "BuildingNameA"),
                            ShowColumns(Filter(TableA, StartsWith(BuildingNameA, q)), "BuildingNameA")
                        )
                    },
                    { L: If(
                            IsBlank(q),
                            ShowColumns(TableB, "BuildingNameB"),
                            ShowColumns(Filter(TableB, StartsWith(BuildingNameB, q)), "BuildingNameB")
                        )
                    }
                ),
                "L"
            ),
            Result
        ),
        Result,
        Ascending
    )
)









// 1) Save selected building
Set(varBuilding, cmbBuilding.Selected.Result);

// 2) Collect filtered rows from each table (pick only columns you need)
ClearCollect(
    colA,
    AddColumns(
        ShowColumns(
            Filter(TableA, BuildingNameA = varBuilding),
            "RecordIdA", "BuildingNameA", "Col1", "Col2"      // <-- replace with columns you need
        ),
        "Source", "A",
        "Building", BuildingNameA
    )
);

ClearCollect(
    colB,
    AddColumns(
        ShowColumns(
            Filter(TableB, BuildingNameB = varBuilding),
            "RecordIdB", "BuildingNameB", "ColX", "ColY"      // <-- replace with columns you need
        ),
        "Source", "B",
        "Building", BuildingNameB
    )
);

// 3) Merge into a single, uniform collection for the gallery
Clear(colMerged);
Collect(colMerged, RenameColumns(colA, "RecordIdA", "RecordId"));
Collect(colMerged, RenameColumns(colB, "RecordIdB", "RecordId"));

// 4) Go to the next screen
Navigate(scrResults, ScreenTransition.Fade)





not searchable 


Sort(
    Distinct(
        Ungroup(
            Table(
                { L: ShowColumns(TableA, "BuildingNameA") },
                { L: ShowColumns(TableB, "BuildingNameB") }
            ),
            "L"
        ),
        Result
    ),
    Result,
    Ascending
)